---
layout: post
title: æºç è§£è¯»ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šRetrofit æºç é‡ç‚¹è§£è¯»
categories: [æºç è§£è¯»]
description: Retrofit æºç é‡ç‚¹è§£è¯»
keywords: Retrofit, ç½‘ç»œ
---


## æºç è§£è¯»ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šRetrofit æºç é‡ç‚¹è§£è¯»

### Retrofit æºç è¦ç‚¹ï¼š

1. è®¾ç½®å¿…è¦å‚æ•°ï¼Œä¾› ServiceMethod è¢«è°ƒç”¨æ—¶ä½¿ç”¨ã€‚

  - BaseUrl 

  - CallAdapterFactoryï¼ˆRxJavaCallAdapterç­‰ï¼‰

  - ConverterFactoryï¼ˆGsonConverterFactoryã€FastjsonConverterFactoryç­‰ï¼‰

  - Call.Factory (OkHttpClient)

  - æ¥å£æ³¨è§£ã€å‚æ•°ã€è¿”å›å€¼ç±»å‹çš„ä¿¡æ¯


2. åŠ¨æ€ä»£ç†

  è°ƒç”¨é¡ºåºï¼š

  - è°ƒç”¨è¯·æ±‚ç½‘ç»œçš„"æ¥å£æ–¹æ³•" ==> 

    åŠ¨æ€ä»£ç†ç±» ==> 

    ç”Ÿæˆ ServiceMethodï¼Œè°ƒç”¨ invoke ==> 

    adapté€‚é…åˆé€‚çš„Callå¹¶è¿”å›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚


3. ServiceMethod
   - åŠ¨æ€ä»£ç†ç±»çš„æ–¹æ³•è°ƒç”¨è¿”å›äº†ç”± HttpCallAdapter åŒ…è£…åçš„ retrofit2.OkHttpCallï¼Œå³ HttpCallAdapterã€‚

   - ServiceMethod (å¯»æ‰¾åˆé€‚çš„CallAdapterFactory) **==>** 

      è°ƒç”¨ CallAdapterFactory#adapt æ–¹æ³•ï¼ŒåŒ…è£…ä¸‹retrofit2.OkHttpCall **==>**

     è¿”å› HttpCallAdapter(å®ç°è‡ªå®šä¹‰HttpCallæ¥å£ï¼Œå’Œretrofit2.Callæ¥å£çš„æ–¹æ³•ç›¸ä¼¼ï¼Œä¿è¯åŸºç¡€è¯·æ±‚åŠŸèƒ½ã€è¡Œä¸ºå¯ç”¨)ç»™ Client è°ƒç”¨ç«¯ **==>**

     å‘é€ HttpCallAdapter åˆ°è¯·æ±‚é˜Ÿåˆ—ï¼ˆHttpCallAdapter.enqueue(è‡ªå®šä¹‰ CallBack) **==>**
     retrofit2.OkHttpCall.enqueue(retrofit2.Callback) **==>**

     okhttp3.Call call = serviceMethod.**callFactory**.newCall(**request**) ï¼‰ï¼Œæœ€ç»ˆä½¿ç”¨ CallFactoryï¼Œä¸€èˆ¬æ˜¯OkHttpClientï¼Œè¯·æ±‚ç½‘ç»œã€‚


4. retrofit æºç ç»“æ„ã€è°ƒç”¨æµç¨‹å›¾
	![retrofit æºç ç»“æ„æµç¨‹å›¾](../images/2019-09-21-retrofit æºç ç»“æ„æµç¨‹å›¾.png)

å¦‚æœ‰ç¼ºæ¼ä¸è¶³ä¹‹å¤„ï¼Œæ¬¢è¿åˆ›å»ºissueï¼ŒPR ğŸ˜„

